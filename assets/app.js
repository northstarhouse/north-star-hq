(()=>{var Me=Object.defineProperty,Pe=Object.defineProperties;var Ue=Object.getOwnPropertyDescriptors;var se=Object.getOwnPropertySymbols;var xe=Object.prototype.hasOwnProperty,ve=Object.prototype.propertyIsEnumerable;var ge=(e,t,r)=>t in e?Me(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,O=(e,t)=>{for(var r in t||(t={}))xe.call(t,r)&&ge(e,r,t[r]);if(se)for(var r of se(t))ve.call(t,r)&&ge(e,r,t[r]);return e},Q=(e,t)=>Pe(e,Ue(t));var be=(e,t)=>{var r={};for(var u in e)xe.call(e,u)&&t.indexOf(u)<0&&(r[u]=e[u]);if(e!=null&&se)for(var u of se(e))t.indexOf(u)<0&&ve.call(e,u)&&(r[u]=e[u]);return r};const{useState:A,useEffect:ce,useMemo:Ke}=React,he="nsh-strategy-metrics-cache-v1",fe="nsh-strategy-sections-cache-v1",ne="nsh-strategy-quarterly-cache-v1",ye="nsh-strategy-major-todos-v1",ue=!0,F="https://script.google.com/macros/s/AKfycbydaZEpixA_RWAQ42HPsrFe6gCrf5bDYhWbj7COlNwmq-tQOOJaBiivRQfahnGq3WIDeQ/exec",Ne=F,De=e=>/^https:\/\/script\.google\.com\/macros\/s\/[^/]+\/exec$/i.test(String(e||"").trim()),Le=()=>{if(!ue)return"";if(!F)return"Google Sheets URL is missing.";const e=String(F).trim();return e.includes("/macros/library/")?"Google Sheets URL is a library link. Use the Web App /exec URL instead.":De(e)?"":"Google Sheets URL must be the Web App /exec link."};const de=[{key:"construction",label:"Construction",sheet:"Construction"},{key:"grounds",label:"Grounds",sheet:"Grounds"},{key:"interiors",label:"Interiors",sheet:"Interiors"},{key:"docents",label:"Docents",sheet:"Docents"},{key:"fund",label:"Fundraising",sheet:"Fundraising"},{key:"events",label:"Events",sheet:"Events"},{key:"marketing",label:"Marketing",sheet:"Marketing"},{key:"venue",label:"Venue",sheet:"Venue"}];const Ze=Array.from({length:11},(e,t)=>t*10),v={isConfigured:()=>ue&&De(F),postJson:async(e,t)=>{const r=await fetch(e,{method:"POST",headers:{"Content-Type":"text/plain;charset=utf-8"},body:JSON.stringify(t)});if(!r.ok){const u=await r.text();throw new Error(`Request failed (${r.status}). ${u||"No response body."}`)}return r.json()},uploadFile:async({filename:e,mimeType:t,data:r})=>{if(!Ne)throw new Error("Drive upload not configured");const u={action:"uploadImage",filename:e,mimeType:t,data:r},f=await v.postJson(Ne,u);if(!f.success)throw new Error(f.error||"Upload failed");return f.result},fetchMetrics:async()=>{if(!v.isConfigured())return null;try{const e=await fetch(`${F}?action=getMetrics`);if(!e.ok)throw new Error("Failed to fetch metrics");return(await e.json()).metrics||null}catch(e){return console.error("Error fetching metrics:",e),null}},submitQuarterlyUpdate:async e=>{if(!v.isConfigured())throw new Error("Google Sheets not configured");const t=await v.postJson(F,{action:"submitQuarterlyUpdate",form:e});if(!t.success)throw new Error(t.error||"Submission failed");return t.result},submitReviewUpdate:async e=>{if(!v.isConfigured())throw new Error("Google Sheets not configured");const t=await v.postJson(F,{action:"submitReviewUpdate",review:e});if(!t.success)throw new Error(t.error||"Submission failed");return t.result},fetchQuarterlyUpdates:async()=>{if(!v.isConfigured())return[];try{const e=await fetch(`${F}?action=getQuarterlyUpdates`);if(!e.ok)throw new Error("Failed to fetch quarterly updates");return(await e.json()).updates||[]}catch(e){return console.error("Error fetching quarterly updates:",e),[]}},fetchSectionSnapshots:async()=>{if(!v.isConfigured())return null;try{const e=await fetch(`${F}?action=getSectionSnapshots`);if(!e.ok)throw new Error("Failed to fetch section snapshots");return(await e.json()).sections||null}catch(e){return console.error("Error fetching section snapshots:",e),null}},fetchMajorTodos:async()=>{if(!v.isConfigured())return[];try{const e=await fetch(`${F}?action=getMajorTodos`);if(!e.ok)throw new Error("Failed to fetch major todos");return(await e.json()).todos||[]}catch(e){return console.error("Error fetching major todos:",e),[]}},saveMajorTodo:async e=>{if(!v.isConfigured())return e;try{const t=await v.postJson(F,{action:"saveMajorTodo",todo:e});if(!t.success)throw new Error(t.error||"Save failed");return t.result}catch(t){return console.error("Error saving major todo:",t),e}},deleteMajorTodo:async e=>{if(!v.isConfigured())return{deleted:!0};try{const t=await v.postJson(F,{action:"deleteMajorTodo",id:e});if(!t.success)throw new Error(t.error||"Delete failed");return t.result}catch(t){return console.error("Error deleting major todo:",t),{deleted:!1}}}},ae=e=>{try{const t=localStorage.getItem(e);return t?JSON.parse(t):null}catch(t){return console.warn("Failed to read cache:",t),null}},z=(e,t)=>{try{localStorage.setItem(e,JSON.stringify(t))}catch(r){console.warn("Failed to write cache:",r)}},$e=()=>`${Date.now()}-${Math.random().toString(16).slice(2,6)}`,Ve=e=>{if(!e)return"N/A";try{return new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}catch(t){return e}},we=e=>{if(!e)return"";const t=new Date(e);if(Number.isNaN(t.getTime()))return e;const r=String(t.getMonth()+1).padStart(2,"0"),u=String(t.getDate()).padStart(2,"0"),f=String(t.getFullYear());return`${r}-${u}-${f}`};const ie=e=>e==null?"N/A":new Intl.NumberFormat("en-US").format(Number(e)||0),Fe=e=>{if(e==null)return"N/A";const t=Number(e)||0;return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",maximumFractionDigits:0}).format(t)},ke=e=>{if(!e)return"";const t=new Date(e);return Number.isNaN(t.getTime())?"":t.toISOString().slice(0,10)},Be=(e,t=3)=>{const r=[];for(String(e||"").split(`
`).map(f=>f.trim()).filter(Boolean).forEach(f=>{const l=f.split("|").map(I=>I.trim()),[T="",E="",M=""]=l;r.push({action:T,owner:E,deadline:M})});r.length<t;)r.push({action:"",owner:"",deadline:""});return r.slice(0,t)},Ce=e=>e.map(t=>[t.action,t.owner,t.deadline].map(r=>r.trim()).join(" | ")).filter(t=>t.replace(/\|/g,"").trim()!=="").join(`
`);const Te=({size:e=24})=>React.createElement("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round"},React.createElement("path",{d:"M12 2l2.5 6 6 2.5-6 2.5-2.5 6-2.5-6L3.5 10.5 9.5 8z"}));const Se=({size:e=22})=>React.createElement("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},React.createElement("path",{d:"M12 2.8l2.7 5.7 6.3.9-4.5 4.4 1.1 6.2L12 17.8 6.4 20l1.1-6.2-4.5-4.4 6.3-.9L12 2.8z"})),_e=({size:e=24})=>React.createElement("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round"},React.createElement("path",{d:"M12 5v14"}),React.createElement("path",{d:"M5 12h14"}));const qe=({size:e=20})=>React.createElement("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},React.createElement("path",{d:"M20 6L9 17l-5-5"})),Ae=({size:e=16})=>React.createElement("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round"},React.createElement("path",{d:"M3 6h18"}),React.createElement("path",{d:"M8 6V4a2 2 0 012-2h4a2 2 0 012 2v2"}),React.createElement("path",{d:"M19 6l-1 14a2 2 0 01-2 2H8a2 2 0 01-2-2L5 6"}));const We=({areaLabel:e,quarter:t,review:r,onSave:u})=>{const f=s=>({statusAfterReview:(s==null?void 0:s.statusAfterReview)||"",actionsRows:Be(s==null?void 0:s.actionsAssigned),crossAreaImpacts:(s==null?void 0:s.crossAreaImpacts)||"",areasImpacted:(s==null?void 0:s.areasImpacted)||"",coordinationNeeded:(s==null?void 0:s.coordinationNeeded)||"",priorityConfirmation:(s==null?void 0:s.priorityConfirmation)||"",escalationFlag:(s==null?void 0:s.escalationFlag)||"",reviewCompletedOn:ke(s==null?void 0:s.reviewCompletedOn),nextCheckInDate:ke(s==null?void 0:s.nextCheckInDate)}),[l,T]=A(()=>f(r)),[E,M]=A(!1),[I,P]=A(!1);ce(()=>{T(f(r))},[r,e,t]),ce(()=>{P(!1)},[e,t]);const C=(s,p)=>{T(h=>Q(O({},h),{[s]:p}))},D=(s,p,h)=>{T(B=>{const _=B.actionsRows.map((H,re)=>re===s?Q(O({},H),{[p]:h}):H);return Q(O({},B),{actionsRows:_})})},o=async()=>{M(!0);const s=l.crossAreaImpacts==="Affects another area",p={focusArea:e,quarter:t,statusAfterReview:l.statusAfterReview,actionsAssigned:Ce(l.actionsRows),crossAreaImpacts:l.crossAreaImpacts,areasImpacted:s?l.areasImpacted:"",coordinationNeeded:s?l.coordinationNeeded:"",priorityConfirmation:l.priorityConfirmation,escalationFlag:l.escalationFlag,reviewCompletedOn:l.reviewCompletedOn,nextCheckInDate:l.nextCheckInDate};try{await u(p)}catch(h){console.error("Failed to save review:",h),alert("Failed to save review. Please try again.")}M(!1)},G=["On track","Minor adjustments needed","Off track - intervention required"],L=["None","Affects another area"],W=["Approved","Adjusted","Replaced"],R=["No escalation needed","Requires board attention","Requires budget review","Requires policy clarification"];if(!I){const p=[{label:"Status After Review",value:l.statusAfterReview},{label:"Actions Assigned",value:Ce(l.actionsRows)},{label:"Cross-Area Impacts",value:l.crossAreaImpacts},{label:"Area(s) impacted",value:l.areasImpacted},{label:"Coordination needed",value:l.coordinationNeeded},{label:"Priority Confirmation (Next Quarter)",value:l.priorityConfirmation},{label:"Escalation Flag",value:l.escalationFlag},{label:"Review completed on",value:l.reviewCompletedOn},{label:"Next check-in date",value:l.nextCheckInDate}].filter(h=>h.value);return React.createElement("div",{className:"bg-white rounded-3xl border border-stone-100 p-5 card-shadow quarter-card"},React.createElement("div",{className:"flex items-center justify-between"},React.createElement("div",{className:"text-xs uppercase tracking-wide text-steel"},t," review"),React.createElement("button",{type:"button",onClick:()=>P(!0),className:"px-3 py-1.5 border border-stone-200 rounded-lg text-xs text-ink"},"Edit review")),p.length===0?React.createElement("div",{className:"mt-4 text-sm text-stone-600"},"No review submitted yet."):React.createElement("div",{className:"mt-4 space-y-2 text-sm text-stone-700"},p.map(h=>React.createElement("div",{key:h.label},React.createElement("div",{className:"text-xs uppercase tracking-wide text-steel"},h.label),React.createElement("div",{className:"whitespace-pre-wrap"},h.value)))))}return React.createElement("div",{className:"bg-white rounded-3xl border border-stone-100 p-5 card-shadow quarter-card"},React.createElement("div",{className:"flex items-center justify-between"},React.createElement("div",{className:"text-xs uppercase tracking-wide text-steel"},t," review"),React.createElement("button",{type:"button",onClick:()=>P(!1),className:"px-3 py-1.5 border border-stone-200 rounded-lg text-xs text-ink"},"Close")),React.createElement("div",{className:"mt-3 space-y-5 text-sm text-stone-700"},React.createElement("div",null,React.createElement("div",{className:"text-xs uppercase tracking-wide text-steel"},"Status After Review"),React.createElement("div",{className:"mt-2 space-y-2"},G.map(s=>React.createElement("label",{key:s,className:"flex items-center gap-2"},React.createElement("input",{type:"radio",name:`${e}-${t}-status`,value:s,checked:l.statusAfterReview===s,onChange:p=>C("statusAfterReview",p.target.value),className:"accent-clay"}),React.createElement("span",null,s))))),React.createElement("div",null,React.createElement("div",{className:"text-xs uppercase tracking-wide text-steel"},"Actions Assigned"),React.createElement("div",{className:"mt-2 grid grid-cols-3 gap-2 text-xs uppercase tracking-wide text-steel"},React.createElement("span",null,"Action"),React.createElement("span",null,"Owner"),React.createElement("span",null,"Deadline")),React.createElement("div",{className:"mt-2 space-y-2"},l.actionsRows.map((s,p)=>React.createElement("div",{key:p,className:"grid grid-cols-1 md:grid-cols-3 gap-2"},React.createElement("input",{type:"text",value:s.action,onChange:h=>D(p,"action",h.target.value),className:"px-3 py-2 border border-stone-200 rounded-lg"}),React.createElement("input",{type:"text",value:s.owner,onChange:h=>D(p,"owner",h.target.value),className:"px-3 py-2 border border-stone-200 rounded-lg"}),React.createElement("input",{type:"text",value:s.deadline,onChange:h=>D(p,"deadline",h.target.value),className:"px-3 py-2 border border-stone-200 rounded-lg"}))))),React.createElement("div",null,React.createElement("div",{className:"text-xs uppercase tracking-wide text-steel"},"Cross-Area Impacts"),React.createElement("div",{className:"mt-2 space-y-2"},L.map(s=>React.createElement("label",{key:s,className:"flex items-center gap-2"},React.createElement("input",{type:"radio",name:`${e}-${t}-impact`,value:s,checked:l.crossAreaImpacts===s,onChange:p=>C("crossAreaImpacts",p.target.value),className:"accent-clay"}),React.createElement("span",null,s)))),l.crossAreaImpacts==="Affects another area"&&React.createElement("div",{className:"mt-3 grid grid-cols-1 gap-3"},React.createElement("div",null,React.createElement("label",{className:"text-xs uppercase tracking-wide text-steel"},"Area(s) impacted"),React.createElement("input",{type:"text",value:l.areasImpacted,onChange:s=>C("areasImpacted",s.target.value),className:"w-full mt-1 px-3 py-2 border border-stone-200 rounded-lg"})),React.createElement("div",null,React.createElement("label",{className:"text-xs uppercase tracking-wide text-steel"},"Coordination needed"),React.createElement("textarea",{value:l.coordinationNeeded,onChange:s=>C("coordinationNeeded",s.target.value),className:"w-full mt-1 px-3 py-2 border border-stone-200 rounded-lg min-h-[90px]"})))),React.createElement("div",null,React.createElement("div",{className:"text-xs uppercase tracking-wide text-steel"},"Priority Confirmation (Next Quarter)"),React.createElement("div",{className:"mt-2 space-y-2"},W.map(s=>React.createElement("label",{key:s,className:"flex items-center gap-2"},React.createElement("input",{type:"radio",name:`${e}-${t}-priority`,value:s,checked:l.priorityConfirmation===s,onChange:p=>C("priorityConfirmation",p.target.value),className:"accent-clay"}),React.createElement("span",null,s))))),React.createElement("div",null,React.createElement("div",{className:"text-xs uppercase tracking-wide text-steel"},"Escalation Flag"),React.createElement("div",{className:"mt-2 space-y-2"},R.map(s=>React.createElement("label",{key:s,className:"flex items-center gap-2"},React.createElement("input",{type:"radio",name:`${e}-${t}-escalation`,value:s,checked:l.escalationFlag===s,onChange:p=>C("escalationFlag",p.target.value),className:"accent-clay"}),React.createElement("span",null,s))))),React.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3"},React.createElement("div",null,React.createElement("label",{className:"text-xs uppercase tracking-wide text-steel"},"Review completed on"),React.createElement("input",{type:"date",value:l.reviewCompletedOn,onChange:s=>C("reviewCompletedOn",s.target.value),className:"w-full mt-1 px-3 py-2 border border-stone-200 rounded-lg"})),React.createElement("div",null,React.createElement("label",{className:"text-xs uppercase tracking-wide text-steel"},"Next check-in date"),React.createElement("input",{type:"date",value:l.nextCheckInDate,onChange:s=>C("nextCheckInDate",s.target.value),className:"w-full mt-1 px-3 py-2 border border-stone-200 rounded-lg"})))),React.createElement("div",{className:"mt-5 flex items-center justify-end"},React.createElement("button",{type:"button",onClick:o,disabled:E,className:"px-4 py-2 bg-clay text-white rounded-lg text-sm"},E?"Saving...":"Save review")))};const Je=({metrics:e,majorTodos:t,onAddTodo:r,onToggleTodo:u,onDeleteTodo:f})=>{const[l,T]=A(""),E=()=>{const o=l.trim();o&&(r(o),T(""))},M=o=>{o.key==="Enter"&&E()},I=t.filter(o=>!o.done),P=t.filter(o=>o.done),C={Voicemails:"https://northstarhouse.github.io/nsh-voicemails/","Events booked":"https://northstarhouse.github.io/north-star-bookings-log/",Volunteers:"https://northstarhouse.github.io/Volunteer-Database/","Donation total":"https://northstarhouse.github.io/donation-database/",Sponsors:"https://northstarhouse.github.io/donation-database/"},D={"Donation total":"Goal: $75,000","Events booked":"Goal: 45",Sponsors:"Goal: 15"};return React.createElement("div",{className:"max-w-6xl mx-auto fade-up"},React.createElement("div",{className:"grid grid-cols-1 lg:grid-cols-[1.2fr_0.8fr] gap-6"},React.createElement("div",{className:"glass rounded-3xl p-6 md:p-8 card-shadow"},React.createElement("div",{className:"flex items-center gap-3 text-gold"},React.createElement(Te,{size:28}),React.createElement("span",{className:"text-xs uppercase tracking-wide"},"The Big Picture")),React.createElement("h2",{className:"font-display text-xl md:text-2xl text-ink mt-4"},"Major Focus To-Do List"),React.createElement("p",{className:"text-stone-500 text-xs mt-1 mb-4"},"The items that matter most right now."),React.createElement("div",{className:"flex gap-2 mb-4"},React.createElement("input",{type:"text",value:l,onChange:o=>T(o.target.value),onKeyDown:M,placeholder:"Add a major focus item...",className:"flex-1 rounded-xl border border-stone-200 px-4 py-2.5 text-sm focus:outline-none focus:ring-2 focus:ring-gold/50 focus:border-gold placeholder:text-stone-400"}),React.createElement("button",{onClick:E,disabled:!l.trim(),className:"bg-gold text-white rounded-xl px-4 py-2.5 text-sm font-medium transition hover:opacity-90 disabled:opacity-40 disabled:cursor-not-allowed flex items-center gap-1.5"},React.createElement(_e,{size:16}),"Add")),React.createElement("div",{className:"space-y-2 max-h-[320px] overflow-y-auto pr-1"},I.length===0&&P.length===0&&React.createElement("p",{className:"text-stone-400 text-sm text-center py-4"},"No items yet. Add your first major focus above."),I.map(o=>React.createElement("div",{key:o.id,className:"flex items-center gap-3 group bg-white rounded-xl border border-stone-100 px-4 py-3 transition hover:border-gold/30"},React.createElement("button",{onClick:()=>u(o.id),className:"w-5 h-5 rounded-md border-2 border-stone-300 flex-shrink-0 transition hover:border-gold flex items-center justify-center","aria-label":"Mark complete"}),React.createElement("span",{className:"text-sm text-ink flex-1"},o.text),React.createElement("button",{onClick:()=>f(o.id),className:"opacity-0 group-hover:opacity-60 hover:!opacity-100 text-stone-400 hover:text-red-500 transition flex-shrink-0","aria-label":"Delete item"},React.createElement(Ae,{size:14})))),P.length>0&&React.createElement("div",{className:"pt-2 border-t border-stone-100 mt-3"},React.createElement("p",{className:"text-[10px] uppercase tracking-wide text-stone-400 mb-2"},"Completed"),P.map(o=>React.createElement("div",{key:o.id,className:"flex items-center gap-3 group rounded-xl px-4 py-2.5 transition"},React.createElement("button",{onClick:()=>u(o.id),className:"w-5 h-5 rounded-md bg-gold/20 border-2 border-gold/40 flex-shrink-0 flex items-center justify-center text-gold","aria-label":"Mark incomplete"},React.createElement(qe,{size:12})),React.createElement("span",{className:"text-sm text-stone-400 line-through flex-1"},o.text,o.completedAt&&React.createElement("span",{className:"ml-2 text-[10px] text-stone-300 no-underline inline-block",style:{textDecoration:"none"}},Ve(o.completedAt))),React.createElement("button",{onClick:()=>f(o.id),className:"opacity-0 group-hover:opacity-60 hover:!opacity-100 text-stone-400 hover:text-red-500 transition flex-shrink-0","aria-label":"Delete item"},React.createElement(Ae,{size:14}))))))),React.createElement("div",{className:"grid grid-cols-2 gap-4"},[{label:"Donation total",value:Fe(e==null?void 0:e.donationsTotal)},{label:"Events booked",value:ie(e==null?void 0:e.eventsCount)},{label:"Sponsors",value:ie(e==null?void 0:e.sponsorsCount)},{label:"Volunteers",value:ie(e==null?void 0:e.volunteersCount)},{label:"Voicemails",value:"Voicemails"}].map(o=>C[o.label]?React.createElement("a",{key:o.label,href:C[o.label],className:"bg-white rounded-2xl p-4 border border-stone-100 card-shadow block transition hover:-translate-y-0.5 hover:shadow-lg focus:outline-none focus-visible:ring-2 focus-visible:ring-gold/60 relative","aria-label":`${o.label} details`},React.createElement("div",{className:"text-xs uppercase tracking-wide text-steel"},o.label),React.createElement("div",{className:"font-display text-2xl text-ink mt-2"},o.value),D[o.label]?React.createElement("div",{className:"absolute bottom-3 right-4 text-[10px] uppercase tracking-wide text-steel"},D[o.label]):null):React.createElement("div",{key:o.label,className:"bg-white rounded-2xl p-4 border border-stone-100 card-shadow relative"},React.createElement("div",{className:"text-xs uppercase tracking-wide text-steel"},o.label),React.createElement("div",{className:"font-display text-2xl text-ink mt-2"},o.value),D[o.label]?React.createElement("div",{className:"absolute bottom-3 right-4 text-[10px] uppercase tracking-wide text-steel"},D[o.label]):null)))))};const Ye=()=>{const[e,t]=A("dashboard"),[r,u]=A(!0),f=Le(),[l,T]=A({donationsTotal:null,volunteersCount:null,eventsCount:null,sponsorsCount:null}),[E,M]=A({Construction:null,Grounds:null,Interiors:null,Docents:null,Fundraising:null,Events:null,Marketing:null,Venue:null}),[I,P]=A(()=>ae(ye)||[]),[C,D]=A([]),[o,G]=A(null),[L,W]=A(null),[R,s]=A(null),[p,h]=A(!1),B=de.reduce((a,i)=>(a[i.key]={label:i.label,key:i.sheet},a),{}),_=a=>{P(a),z(ye,a)},H=a=>{const i={id:$e(),text:a,done:!1,createdAt:new Date().toISOString(),completedAt:""},g=[...I,i];_(g),v.saveMajorTodo(i)},re=a=>{const i=I.map(g=>{if(g.id!==a)return g;const n=Q(O({},g),{done:!g.done,completedAt:g.done?"":new Date().toISOString()});return v.saveMajorTodo(n),n});_(i)},Ie=a=>{const i=I.filter(g=>g.id!==a);_(i),v.deleteMajorTodo(a)};ce(()=>{oe()},[]);const oe=async({useCache:a=!0}={})=>{var m;if(!ue){u(!1);return}u(!0);const i=a?ae(he):null,g=a?ae(fe):null,n=a?ae(ne):null;i&&T(i),g&&M(g),n&&D(n);try{const x=await Promise.allSettled([v.fetchMetrics(),v.fetchSectionSnapshots(),v.fetchMajorTodos()]),[S,y,j]=x;S.status==="fulfilled"&&S.value&&(T(S.value),z(he,S.value)),y.status==="fulfilled"&&y.value&&(M(y.value),z(fe,y.value)),j.status==="fulfilled"&&((m=j.value)!=null&&m.length)&&_(j.value)}catch(x){console.error("Failed to load data:",x)}u(!1),setTimeout(async()=>{try{const x=await v.fetchQuarterlyUpdates();x.length&&(D(x),z(ne,x))}catch(x){console.error("Failed to load quarterly updates:",x)}},0)},je=async a=>{const m=a,{focusArea:i,quarter:g}=m,n=be(m,["focusArea","quarter"]);await v.submitReviewUpdate(a),D(x=>{const S=x.findIndex(q=>q.focusArea===i&&q.quarter===g),y=S>=0?Q(O({},x[S]),{payload:Q(O({},x[S].payload||{}),{review:n})}):{focusArea:i,quarter:g,submittedDate:"",payload:{review:n}},j=S>=0?x.map((q,le)=>le===S?y:q):[...x,y];return z(ne,j),j})},Oe=(a,i)=>{const n=C.filter(y=>y.focusArea===a&&y.quarter===i).sort((y,j)=>new Date(j.submittedDate||j.createdAt)-new Date(y.submittedDate||y.createdAt))[0],m=(n==null?void 0:n.payload)||{},x=m.year||String(new Date().getFullYear()),S=m.submittedDate||(n==null?void 0:n.submittedDate)||new Date().toISOString().slice(0,10);G({focusArea:a,quarter:i,year:x,submittedDate:S,primaryFocus:m.primaryFocus||"",goals:m.goals&&m.goals.length?m.goals:[{goal:"",status:"On Track",summary:""},{goal:"",status:"On Track",summary:""},{goal:"",status:"On Track",summary:""}],wins:m.wins||"",challenges:m.challenges||{},supportNeeded:m.supportNeeded||"",supportTypes:m.supportTypes||{},decisionsNeeded:m.decisionsNeeded||"",nextQuarterFocus:m.nextQuarterFocus||"",nextPriorities:m.nextPriorities||["","",""],finalTallyOverview:m.finalTallyOverview||""}),t("quarterly"),window.scrollTo(0,0)},Qe=(a,i,g,n)=>{if(i!=="Q1")return;const m=n.year||String(new Date().getFullYear()),x=n.submittedDate||(g==null?void 0:g.submittedDate)||new Date().toISOString().slice(0,10);W({areaLabel:a,quarter:i}),s({focusArea:a,quarter:i,year:m,submittedDate:x,primaryFocus:n.primaryFocus||"",goals:n.goals&&n.goals.length?n.goals:[{goal:"",status:"On Track",summary:""},{goal:"",status:"On Track",summary:""},{goal:"",status:"On Track",summary:""}],wins:n.wins||"",challenges:n.challenges||{},supportNeeded:n.supportNeeded||"",supportTypes:n.supportTypes||{},decisionsNeeded:n.decisionsNeeded||"",nextQuarterFocus:n.nextQuarterFocus||"",nextPriorities:n.nextPriorities||["","",""],finalTallyOverview:n.finalTallyOverview||"",uploadedFiles:n.uploadedFiles||[]})},Re=async()=>{if(R){h(!0);try{await v.submitQuarterlyUpdate(Q(O({},R),{primaryOnly:!0})),await oe({useCache:!1}),W(null),s(null)}catch(a){console.error("Failed to save inline quarterly update:",a),alert("Failed to save. Please try again.")}h(!1)}},Ge=async()=>{await oe({useCache:!1}),G(null),t("dashboard")};return React.createElement("div",{className:"min-h-screen"},React.createElement("header",{className:"sticky top-0 z-40 bg-white/90 backdrop-blur border-b border-stone-100"},React.createElement("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8"},React.createElement("div",{className:"flex items-center justify-between h-16"},React.createElement("div",{className:"flex items-center gap-3"},React.createElement("div",{className:"w-10 h-10 rounded-full border border-gold/40 bg-white text-gold flex items-center justify-center shadow-sm"},React.createElement(Te,{size:18})),React.createElement("div",null,React.createElement("div",{className:"font-display text-lg text-ink"},"Haley\u2019s Star Command"),React.createElement("div",{className:"text-xs text-steel"},"Mission Control"))),React.createElement("div",{className:"flex items-center gap-2 text-sm flex-wrap"})),React.createElement("div",{className:"pb-4"},React.createElement("div",{className:"flex flex-wrap gap-3"},React.createElement("button",{onClick:()=>t("dashboard"),className:`tab-button text-sm min-w-[200px] ${e==="dashboard"?"active":""}`},"2026 Snapshot"),React.createElement("select",{value:de.some(a=>a.key===e)?e:"",onChange:a=>{const i=a.target.value;i&&t(i)},className:"tab-button tab-select text-sm bg-white min-w-[220px]"},React.createElement("option",{value:""},"Operational Areas"),de.map(a=>React.createElement("option",{key:a.key,value:a.key},a.label))))))),React.createElement("main",{className:"px-4 sm:px-6 lg:px-8 py-8"},f&&React.createElement("div",{className:"max-w-4xl mx-auto mb-6 rounded-2xl border border-amber-200 bg-amber-50 px-5 py-4 text-sm text-amber-800"},f),r?React.createElement("div",{className:"max-w-4xl mx-auto bg-white rounded-2xl border border-stone-100 p-8 text-center text-stone-600"},"Loading Haley\u2019s Organized Chaos..."):React.createElement(React.Fragment,null,e==="dashboard"&&React.createElement(Je,{metrics:l,majorTodos:I,onAddTodo:H,onToggleTodo:re,onDeleteTodo:Ie}),["construction","grounds","interiors","docents","fund","events","marketing","venue"].includes(e)&&React.createElement("div",{className:"max-w-4xl mx-auto fade-up"},React.createElement("div",{className:"bg-white rounded-3xl border border-stone-100 p-6 md:p-8 card-shadow"},React.createElement("div",{className:"flex items-start justify-between gap-3"},React.createElement("h2",{className:"font-display text-3xl text-ink"},B[e].label),React.createElement("div",{className:"flex items-center gap-2"})),React.createElement("p",{className:"text-stone-600 mt-2"},"Beginning 2026 snapshot."),React.createElement("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-3 gap-4"},(()=>{const a=E[B[e].key];return React.createElement(React.Fragment,null,React.createElement("div",{className:"bg-stone-50 rounded-2xl p-4 border border-stone-100"},React.createElement("div",{className:"text-xs uppercase tracking-wide text-steel"},"Lead name"),React.createElement("div",{className:"text-lg text-ink mt-2"},(a==null?void 0:a.lead)||"N/A")),React.createElement("div",{className:"bg-stone-50 rounded-2xl p-4 border border-stone-100"},React.createElement("div",{className:"text-xs uppercase tracking-wide text-steel"},"Budget"),React.createElement("div",{className:"text-lg text-ink mt-2"},a!=null&&a.budget?Fe(a.budget):"N/A")),React.createElement("div",{className:"bg-stone-50 rounded-2xl p-4 border border-stone-100"},React.createElement("div",{className:"text-xs uppercase tracking-wide text-steel"},"Volunteers (2026)"),React.createElement("div",{className:"text-lg text-ink mt-2"},(a==null?void 0:a.volunteers)||"N/A")))})())),(()=>{const a=B[e].label,i=[["Q1","Q2"],["Q3","Q4"]],g={Q1:"Jan 1 - Mar 31",Q2:"Apr 1 - Jun 30",Q3:"Jul 1 - Sep 30",Q4:"Oct 1 - Dec 31"},n={Q1:"Due: March 30th",Q2:"Due: June 30th",Q3:"Due: September 30th",Q4:"Due: December 31st"},m={capacity:"Capacity or volunteer limitations",budget:"Budget or funding constraints",scheduling:"Scheduling or timing issues",coordination:"Cross-area coordination gaps",external:"External factors",other:"Other"},x={staff:"Staff or volunteer help",marketing:"Marketing or communications",board:"Board guidance or decision",funding:"Funding or fundraising support",facilities:"Facilities or logistics",other:"Other"},S=c=>{switch(c){case"Q2":return"Q1";case"Q3":return"Q2";case"Q4":return"Q3";default:return null}},y=c=>C.filter(d=>d.focusArea===a&&d.quarter===c).sort((d,w)=>new Date(w.submittedDate||w.createdAt)-new Date(d.submittedDate||d.createdAt))[0],j=c=>{const b=N=>String(N||"").trim().toLowerCase()==="none noted",d=y(c),w=(d==null?void 0:d.payload)||{},$=S(c),V=$?y($):null,J=(V==null?void 0:V.payload)||{},K=(J.nextPriorities||[]).map(N=>({goal:N||"",status:"",summary:""})).filter(N=>String(N.goal||"").trim()&&!b(N.goal)),Z=w.goals&&w.goals.length?w.goals:K.length?K:[{},{},{}],X=w.primaryFocus||(b(J.nextQuarterFocus)?"":J.nextQuarterFocus),ee=(L==null?void 0:L.areaLabel)===a&&(L==null?void 0:L.quarter)===c,Y=w.submittedDate||(d==null?void 0:d.submittedDate)||"",pe=c==="Q1";return React.createElement("div",{key:`primary-${c}`,className:"bg-white rounded-3xl border border-stone-100 p-6 card-shadow quarter-card flex flex-col"},React.createElement("div",{className:"flex items-start justify-between gap-3"},React.createElement("div",{className:"text-xl font-display text-ink"},`${c} Primary Focus and Goals`),React.createElement("div",{className:"text-xs uppercase tracking-wide text-steel"},g[c])),ee?React.createElement("div",{className:"mt-4 space-y-4"},React.createElement("div",null,React.createElement("div",{className:"text-xs uppercase tracking-wide text-steel font-semibold"},"Primary focus"),React.createElement("textarea",{value:(R==null?void 0:R.primaryFocus)||"",onChange:N=>s(U=>Q(O({},U),{primaryFocus:N.target.value})),className:"w-full mt-2 px-3 py-2 border border-stone-200 rounded-lg min-h-[100px]",placeholder:"Main priorities or themes."})),React.createElement("div",null,React.createElement("div",{className:"text-xs uppercase tracking-wide text-steel font-semibold"},"Goals"),React.createElement("div",{className:"mt-2 space-y-3"},((R==null?void 0:R.goals)||[]).map((N,U)=>React.createElement("div",{key:U},React.createElement("input",{type:"text",value:N.goal,onChange:k=>s(te=>Q(O({},te),{goals:te.goals.map((me,Ee)=>Ee===U?Q(O({},me),{goal:k.target.value}):me)})),className:"px-3 py-2 border border-stone-200 rounded-lg",placeholder:`Goal ${U+1}`}))))),React.createElement("div",{className:"flex items-center justify-end gap-2"},React.createElement("button",{type:"button",onClick:()=>{W(null),s(null)},className:"px-3 py-2 border border-stone-200 rounded-lg text-sm",disabled:p},"Cancel"),React.createElement("button",{type:"button",onClick:Re,className:"px-3 py-2 bg-gold text-white rounded-lg text-sm",disabled:p},p?"Saving...":"Save"))):React.createElement("div",{className:"mt-4 space-y-3 text-sm text-stone-700"},React.createElement("div",null,React.createElement("div",{className:"text-xs uppercase tracking-wide text-steel font-semibold"},"Primary focus"),React.createElement("div",{className:"whitespace-pre-line"},X||"-")),React.createElement("div",null,React.createElement("div",{className:"text-xs uppercase tracking-wide text-steel font-semibold"},"Goals"),React.createElement("div",{className:"space-y-1"},Z.map((N,U)=>React.createElement("div",{key:U,className:"flex items-start gap-2"},React.createElement("span",{className:"text-gold mt-0.5"},React.createElement(Se,{size:12})),React.createElement("div",null,React.createElement("span",null,N.goal||"-"))))))),React.createElement("div",{className:"mt-4 flex items-center justify-between text-xs text-steel"},React.createElement("div",null,Y?we(Y):"00-00-0000"),pe&&React.createElement("button",{type:"button",onClick:()=>Qe(a,c,d,w),className:"px-2 py-1 border border-stone-200 rounded-lg text-xs"},"Edit")))},q=c=>{const b=y(c),d=(b==null?void 0:b.payload)||{},w=d.submittedDate||(b==null?void 0:b.submittedDate)||"",$=d.challenges||{},V=d.supportTypes||{},J=d.challengesChecked||"",K=d.supportTypesChecked||"",Z=Object.keys(m).filter(k=>$[k]).map(k=>k==="other"&&$.otherText?`Other: ${$.otherText}`:m[k]),X=Object.keys(x).filter(k=>V[k]).map(k=>k==="other"&&V.otherText?`Other: ${V.otherText}`:x[k]),ee=J||(Z.length?Z.join(", "):""),Y=K||(X.length?X.join(", "):""),N=(d.nextPriorities||[]).filter(k=>String(k||"").trim()),U=!!(d.wins||$.details||ee||d.supportNeeded||Y||d.nextQuarterFocus||N.length||d.decisionsNeeded);return React.createElement("div",{key:`overview-${c}`,className:"bg-white rounded-3xl border border-stone-100 p-6 card-shadow quarter-card flex flex-col"},React.createElement("div",{className:"flex items-start justify-between gap-3"},React.createElement("div",null,React.createElement("div",{className:"text-lg font-display text-ink"},`${c} Quarterly Reflection`),React.createElement("div",{className:"text-xs uppercase tracking-wide text-steel"},g[c])),React.createElement("div",{className:"text-right"},React.createElement("div",{className:"text-xs uppercase tracking-wide text-steel"},n[c]))),!b||!U?React.createElement("div",{className:"mt-4 text-sm text-stone-600"},"No submission yet."):React.createElement("div",{className:"mt-4 space-y-3 text-sm text-stone-700"},React.createElement("div",null,React.createElement("div",{className:"text-xs uppercase tracking-wide text-steel"},"What went well"),React.createElement("div",{className:"whitespace-pre-line"},d.wins||"None noted")),React.createElement("div",null,React.createElement("div",{className:"text-xs uppercase tracking-wide text-steel"},"Challenges"),React.createElement("div",{className:"whitespace-pre-line"},$.details||"None noted")),React.createElement("div",null,React.createElement("div",{className:"text-xs uppercase tracking-wide text-steel"},"Challenges (checked)"),React.createElement("div",null,ee||"None noted")),React.createElement("div",null,React.createElement("div",{className:"text-xs uppercase tracking-wide text-steel"},"Support needed"),React.createElement("div",{className:"whitespace-pre-line"},d.supportNeeded||"None noted")),React.createElement("div",null,React.createElement("div",{className:"text-xs uppercase tracking-wide text-steel"},"Support types"),React.createElement("div",null,Y||"None noted")),React.createElement("div",null,React.createElement("div",{className:"text-xs uppercase tracking-wide text-steel"},"Next quarter focus area and goals"),React.createElement("div",{className:"whitespace-pre-line"},d.nextQuarterFocus||"None noted"),React.createElement("div",{className:"mt-2 space-y-1"},N.length?N.map((k,te)=>React.createElement("div",{key:te,className:"flex items-start gap-2"},React.createElement("span",{className:"text-gold mt-0.5"},React.createElement(Se,{size:12})),React.createElement("div",null,k||"-"))):React.createElement("div",null,"None noted"))),React.createElement("div",null,React.createElement("div",{className:"text-xs uppercase tracking-wide text-steel"},"Other notes"),React.createElement("div",{className:"whitespace-pre-line"},d.decisionsNeeded||"None noted"))),React.createElement("div",{className:"mt-4 flex items-center justify-between text-xs text-steel"},React.createElement("div",null,w?we(w):"00-00-0000"),React.createElement("button",{type:"button",onClick:()=>Oe(a,c),className:"px-2 py-1 border border-stone-200 rounded-lg text-xs"},"Edit")))},le=c=>{var w;const b=y(c),d=((w=b==null?void 0:b.payload)==null?void 0:w.review)||null;return React.createElement(We,{key:`review-${c}`,areaLabel:a,quarter:c,review:d,onSave:je})};return React.createElement("div",{className:"mt-6 space-y-6"},i.map(c=>React.createElement("div",{key:c.join("-"),className:"space-y-6"},React.createElement("div",{className:"grid grid-cols-2 gap-4"},c.map(b=>j(b))),React.createElement("div",{className:"grid grid-cols-2 gap-4"},c.map(b=>q(b))),React.createElement("div",{className:"grid grid-cols-2 gap-4"},c.map(b=>le(b))))))})()))))},ze=ReactDOM.createRoot(document.getElementById("root"));ze.render(React.createElement(Ye,null));})();
